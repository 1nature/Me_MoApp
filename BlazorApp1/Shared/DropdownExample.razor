@page "/dropdown"
@using BlazorApp1.Data
@using Me_MoApp
@inject VendorDataService vendorDataService;

@* <EditForm Model="Vendor" OnSubmit="UpdatePostValue">
    <div class="col-md-6">
        <br />
        <br />

        <label for="vendor_name" class="form-label">Add your vendor</label>
        <InputText @bind-Value="Vendor.BusinessName"></InputText>
        <label for="vendor_door_number" class="form-label">Add your door number</label>
        <InputText @bind-Value="Vendor.Address.Door" placeholder="Door number"></InputText>

    </div>
    <br />
    <button type="submit">Send</button>

</EditForm> *@


<div class="col-md-8">
    <br />
    <label for="vendor_name" class="form-label">Choose from vendor list </label>
    <InputText @bind-Value="_selectedVendorString" class="form-control" list="datalistOptions" id="exampleDataList" placeholder="Type to search..." />
    <datalist id="datalistOptions">
        @foreach (var vendor in vendorDataService.GetVendors())
        {
            <option value="@vendor.BusinessName" />
        }

    </datalist>
    @if (vendorDataService.GetVendorByName(_selectedVendorString) == null)
    {
        <AddVendorExample Vendor="selectedVendor"/>
        //2-way binding component for adding new vendor and updating the vendor list(parent)
    }
    else
    {
        <button @onclick="UpdatePostValue">Select Vendor</button>
    }

</div>

@code {



    public Vendor Vendor { get; set; } = new();

    private Vendor selectedVendor { get; set; } = new();

    string _selectedVendorString { get; set; }

    [Parameter]
    public Post Post { get; set; } = new();

    [Parameter]
    public EventCallback<Post> PostChanged { get; set; } // what does this do?






    async Task UpdatePostValue()
    {
        selectedVendor = vendorDataService.GetVendorByName(_selectedVendorString);

        Post.Vendor.Add(selectedVendor);
        await PostChanged.InvokeAsync(Post);
    }

    // async Task UpdatePostData()
    // {
    //     Post.Vendor.Add(Vendor);
    //     await PostChanged.InvokeAsync(Post);
    //     Vendor = new();
    // }

    //Dropdown list and addvendorentry cannot be adding to Post at the same time. It has to be one time
    //Betterstill, merge them

    //Dropdown list & addvendor entry are adding vendors to the Post at the same time
    //Vendor should be added by either component with one button click

}
